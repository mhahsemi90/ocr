{% extends 'ocr_app/base.html' %}
{% load permission_tags %}

{% block page_title %}Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø³ØªØ±Ø³ÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±{% endblock %}

{% block content %}
<div class="header">
    <h1>Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø³ØªØ±Ø³ÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±: {{ target_user.username }}</h1>
    <button class="btn" onclick="location.href='{% url 'user_management' %}'"
            style="background: #95a5a6; color: white;">
        â†©ï¸ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†
    </button>
</div>

<div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
        <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± -->
        <div>
            <h3 style="color: #2c3e50; margin-bottom: 20px;">ğŸ“‹ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±</h3>
            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px;">
                <p><strong>Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ:</strong> {{ target_user.username }}</p>
                <p><strong>Ù†Ø§Ù… Ú©Ø§Ù…Ù„:</strong> {{ target_user.get_full_name|default:"-" }}</p>
                <p><strong>Ø§ÛŒÙ…ÛŒÙ„:</strong> {{ target_user.email|default:"-" }}</p>
                <p><strong>Ù†Ù‚Ø´:</strong> 
                    {% if target_user.is_superuser %}
                    <span class="access-badge access-allowed">Ù…Ø¯ÛŒØ± Ø³ÛŒØ³ØªÙ…</span>
                    {% else %}
                    <span class="access-badge">Ú©Ø§Ø±Ø¨Ø± Ø¹Ø§Ø¯ÛŒ</span>
                    {% endif %}
                </p>
            </div>
        </div>

        <!-- Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø³ØªØ±Ø³ÛŒâ€ŒÙ‡Ø§ -->
        <div>
            <h3 style="color: #2c3e50; margin-bottom: 20px;">ğŸ” Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø³ØªØ±Ø³ÛŒâ€ŒÙ‡Ø§</h3>
            <form method="post">
                {% csrf_token %}
                <div style="background: #f8f9fa; padding: 20px; border-radius: 8px;">
                    {% for permission_value, permission_name in permission_choices %}
                    <div style="margin-bottom: 15px; padding: 10px; background: white; border-radius: 5px; border: 1px solid #e0e0e0;">
                        <label style="display: flex; align-items: center; justify-content: space-between;">
                            <span style="font-weight: bold;">{{ permission_name }}</span>
                            <input type="checkbox" name="permissions" value="{{ permission_value }}" 
                                   {% if target_user|has_perm:permission_value %}checked{% endif %}
                                   style="margin-left: 10px;"
                                   {% if target_user.is_superuser %}disabled{% endif %}>
                        </label>
                        {% if target_user.is_superuser %}
                        <small style="color: #7f8c8d; display: block; margin-top: 5px;">
                            Ú©Ø§Ø±Ø¨Ø± Ù…Ø¯ÛŒØ± Ø³ÛŒØ³ØªÙ… Ø¨Ù‡ Ù‡Ù…Ù‡ Ø¨Ø®Ø´â€ŒÙ‡Ø§ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¯Ø§Ø±Ø¯
                        </small>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>

                {% if not target_user.is_superuser %}
                <div style="margin-top: 20px; text-align: center;">
                    <button type="submit" class="btn btn-primary">
                        ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ ØªØºÛŒÛŒØ±Ø§Øª
                    </button>
                </div>
                {% endif %}
            </form>
        </div>
    </div>
</div>

<style>
    .access-badge {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 3px;
        font-size: 10px;
        margin-right: 5px;
    }
    
    .access-allowed {
        background: #27ae60;
        color: white;
    }
</style>
{% endblock %}